<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html;charset=UTF-8" />

    <script language="javascript" defer="true">
      tstUsername = "";
      tstUserKeyboardPref = "qwerty";
      var d = new Date();
      d.toDateString();
    </script>
    <script type="text/javascript" src="/public/touchscreentoolkit/lib/javascripts/touchScreenToolkit.js" defer="true"></script>
    <script type="text/javascript" src="/assets/js/jquery.min.js"></script>
    <script type="text/javascript" src="/assets/js/data.js"></script>
    <script type="text/javascript" src="/assets/js/core.js"></script>
    <script type="text/javascript" src="/assets/js/moment.js"></script>

  </head>
  <body id="mateme">
    <div id="container">
      <div id="content">
        <script>
          var tt_cancel_destination = "/";
        </script>
<style>
  h1 { padding-left:10px; }

  .user_info {
    background-color: #DDDDDD;
    height: 461px;
    border-bottom: 1px solid black;
    border-top: 1px solid black;
    margin-top: 1px;
    font-size:25px;
  }

  .userdata {
    background: none repeat scroll 0 0 white;
    border: 1px solid black;
    margin-left:70px;
    width: 90%;
    border-collapse: collapse;
   position: center;
  }

  .userdata td, .userdata th {
    border-width: 0px;
    border-style:solid;
  }

  th { text-align:left; }

  .blue { background-color:#E6E6FF; }

  .user_info button {
    margin-top: 10px;
    font-size: 1.2em;
    font-weight: bold;
    margin: 0 4px;
    float:right;
  }

  #button_container button {
    font-size: 15px;
    width: 235px;
  }
</style>

<br />
<h1>Dead Patients With Encounters After Death</h1>
<br />
<div class = 'user_info' style="overflow-y:scroll">
  <table class = 'userdata' id="userdata">
    <tr>
      <th class='blue'>First name:</th>
    
      <th class='blue'>Last name</th>
    
      <th class='blue'>Dead Status</th>
    
      <th class='blue'>Death Date</th>
    
      <th class='blue'>Encounter Date</th>
    
    </tr>
    <tr id="inner-data">

    </tr>
</table>

  <div id="nav" style="position: absolute;bottom: 0%; left: 0px; width:99.5%; height: 10%; background: #333333;">
    <button onmousedown ="location = '/ '" class="green" style="float: right; margin-right: 20px; margin-top: 9px; width: 150px;" onclick="setUser();window.location= tt_cancel_destination">
      <span>
        Finish
      </span>
    </button>

  </div>
</div>

        <div id="footer">
        </div>
      </div>
    </div>
  </body>
</html>

<script type="text/javascript">

      
function getDeadEncounters() {
    var url = apiProtocol + "://" + apiURL + ":" + apiPort + "/api/v1/dead_encounters";
    //var f = document.getElementById("inner-data");
    var xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function () {
        if (this.readyState == 4 && (this.status == 201 || this.status == 200)) {
            var table = document.getElementById("userdata");
            var obj = JSON.parse(this.responseText);
            console.log(obj);
            for (var index = 0; index < obj.length; index++) {
                var tr = document.createElement("tr");
                table.appendChild(tr);

                var td = document.createElement("td");
                td.innerHTML = obj[index].given_name;
                tr.appendChild(td);

                var td = document.createElement("td");
                td.innerHTML = obj[index].family_name;
                tr.appendChild(td); 

                var td = document.createElement("td");
                td.innerHTML = obj[index].dead;
                tr.appendChild(td);

                var td = document.createElement("td");
                td.innerHTML = obj[index].death_date;
                tr.appendChild(td);

                var td = document.createElement("td");
                td.innerHTML = obj[index].encounter_datetime;
                tr.appendChild(td);
            }
        }
    };
    xhttp.open("GET", url, true);
    xhttp.setRequestHeader('Authorization', sessionStorage.getItem("authorization"));
    xhttp.setRequestHeader('Content-type', "application/json");
    xhttp.send();
}


   // var oRows = document.getElementById('userdata').getElementsByTagName('tr');
  //  var iRowCount = oRows.length;
   // alert('Your table has ' + iRowCount + ' rows.');
          

getDeadEncounters();
  
</script>